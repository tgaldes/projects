/home/tgaldes/.local/lib/python3.5/site-packages/OpenSSL/crypto.py:14: CryptographyDeprecationWarning: Python 3.5 support will be dropped in the next release of cryptography. Please upgrade your Python.
  from cryptography import utils, x509
/usr/local/lib/python3.5/dist-packages/requests/__init__.py:91: RequestsDependencyWarning: urllib3 (1.26.3) or chardet (3.0.4) doesn't match a supported version!
  RequestsDependencyWarning)
Traceback (most recent call last):
  File "/cfld/projects/cfld/gmail/framework/main.py", line 81, in <module>
    m.run()
  File "/cfld/projects/cfld/gmail/framework/main.py", line 58, in run
    self.inboxes[inbox].refresh()
  File "/cfld/projects/cfld/gmail/framework/Inbox.py", line 33, in refresh
    self.service.refresh()
  File "/cfld/projects/cfld/gmail/services/gmail/GMailService.py", line 124, in refresh
    self.__populate_query_result(self.default_query, self.default_limit)
  File "/cfld/projects/cfld/gmail/services/gmail/GMailService.py", line 91, in __populate_query_result
    thread_map = self.service.users().threads().get(userId='me', id=item['id'], format='full').execute()
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/_helpers.py", line 134, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/usr/local/lib/python3.5/dist-packages/googleapiclient/http.py", line 907, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 500 when requesting https://gmail.googleapis.com/gmail/v1/users/me/threads/1777a77137389807?format=full&alt=json returned "Internal error encountered.">



If an expression matcher is created with just whitespace, we should treat is as empty and log a warning or error or throw that we're ignoring it
bump default number of emails we query in prod version
parking will always match, need to look at the delimiters I'm using to avoid looking at the bodies of old emails
we will go mid thread into a contact form and create a draft directing them to the application, stop doing that
Thread.send should update the state of the thread and service list of drafts


rule additions

1) add a thanks for reaching out at the start of the new submission handler
2) rule to remove the inbox label from 'Rental Application submitted' or Rental Application approved' emails once we've run our redirect actions
3) add thanks for reaching out to the 'Before we put you in touch with our ....'. We can also delete the existing draft when we match this rule so that I don't have to manually clear the line
4) add a send rule for 3rd party matches with drafts. We're ready (are we though?)
5) redirect rule for 'Just sent the lease out. Let me know if you have any questions.'
6) redirect rule for signed lease 'Thanks for getting the lease out, I've sent you an invite for buildium where you'll be able to pay rent'
7) Longer explanation of application to match a 3rd party 'what is your application process'
8) rule for 'sent you an invite to our tenant portal'
5) add send rule for 3rd party make them say no
